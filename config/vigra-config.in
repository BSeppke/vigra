#!/bin/sh
# @configure_input@

usage()
{
  if test -z '@FFTW3_LIBRARY@'; then
    fftwstatus=" (not configured)"
    fftwflags=" (fftw not configured)"
  else
    fftwflags=" and fftw"
  fi

  cat <<EOF
Usage: $0 [OPTIONS]
Options:
    [--version]      output version ("@vigra_version@")
    [--target]       output platform this VIGRA library was configured for
    [--impex-lib]    output flags for linking libvigraimpex
    [--fftw-lib]     output flags for linking libfftw$fftwstatus
    [--rfftw-lib]    output flags for linking librfftw and libfftw$fftwstatus
    [--cppflags]     output include flags for vigra$fftwflags
    [--include-path] output path to VIGRA includes
    [--docdir]       output path to VIGRA documentation
   ([--libs]         synonym for --impex-lib)
EOF
    exit $1
}

if test $# -eq 0; then
    echo "ERROR: no parameters given!" 1>&2
    usage 1 1>&2
fi

try=false

while test $# -gt 0; do
  case $1 in
    --version)
      echo @vigra_version@
      ;;
    --target|--platform)
      echo @target@ # FIXME (remove?)
      ;;
    --cppflags|--cxxincludes|--cxxflags|--cincludes|--cflags)
      echo '-I@CMAKE_INSTALL_PREFIX@/include'
      ;;
    --impex_lib|--impex-lib|--libs)
      echo '-L@CMAKE_INSTALL_PREFIX@/lib@LIBDIR_SUFFIX@ -limpex @vigraimpex_LIB_DEPENDS@' # FIXME (PREFIX/lib[64] missing, _LIB_DEPENDS formatting -> linker args)
      ;;
    --fftw_lib|--fftw-lib)
      if test -z '@FFTW3_LIBRARY@'; then
        echo "VIGRA was configured without fftw switches, libpath unknown!" 1>&2
      else
        echo '@FFTW3_LIBRARY@' # FIXME (formatting -> linker args)
      fi
      ;;
    --rfftw_lib|--rfftw-lib) # FIXME (currently not configured, remove?)
      if test -z '@RFFTW3_LIBRARY@'; then
        echo "VIGRA was configured without fftw switches, libpath unknown!" 1>&2
      else
        echo '@RFFTW3_LIBRARY@'
      fi
      ;;
    --include_path|--include-path|--includepath)
      echo '@CMAKE_INSTALL_PREFIX@/include'
      ;;
    --docdir)
      echo '@DOCDIR@'
      ;;
    --help|-h|-?)
      usage 0 1>&2
      ;;
    --try)
      try=true
      ;;
    *)
      if $try; then
        exit 2
      else
        echo "ERROR: unknown parameter '$1'!"
        usage 2 1>&2
      fi
      ;;
  esac
  shift
done
