<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><TITLE>vigra - Fast Fourier Transform</TITLE>
<link rel=stylesheet type="text/css" href="vigra.css">
<link rel=stylesheet type="text/css" href="vigra_1_8_2.css">
<link rel="shortcut icon" href="vigra-icon.ico" />
<script type="text/javascript">
function toggleHiddenDocumentation( textID, toggleID, toggleMessage )
{ 
	if( document.getElementById(textID).style.display == 'none' )
    {
		document.getElementById(textID).style.display = 'block';
        document.getElementById(toggleID).innerHTML = "hide " + toggleMessage;
    }
    else
    {
		document.getElementById(textID).style.display = 'none';
        document.getElementById(toggleID).innerHTML = "show " + toggleMessage;
	}
    return false;
}
</script>
</head>
<body  bgcolor="#f8f0e0" link="#0040b0" vlink="#a00040">
<basefont face="Helvetica,Arial,sans-serif" size=3>
<p align=right>
[ <a href="http://hci.iwr.uni-heidelberg.de/vigra/">VIGRA Homepage</a> |
 <a href="functionindex.html">Function Index</a> |
 <a href="classes.html">Class Index</a> |
 <a href="namespaces.html">Namespaces</a> |
 <a href="files.html">File List</a> |
 <a href="index.html">Main Page</a> ]
</p>
<!-- Generated by Doxygen 1.7.6.1 -->
</div>
<div class="contents">
<table class="main_heading">
<tr>
<td align=left>
<A HREF ="#_details" ><IMG BORDER=0 ALT="details" title="Detailed Description" SRC="documents/pfeilGross.gif"></A>
</td>
<td width="100%">Fast Fourier Transform
</td>
<td align=right><a href="http://hci.iwr.uni-heidelberg.de/vigra/"><IMG border=0 ALT="VIGRA" SRC="documents/vigra.gif" title="VIGRA Homepage"></a></td></tr>
</table><p>

<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvigra_1_1FFTWConvolvePlan.html">FFTWConvolvePlan&lt; N, Real &gt;</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvigra_1_1FFTWPlan.html">FFTWPlan&lt; N, Real &gt;</a></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;... &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__FourierTransform.html#gad51931cfe91ece316e28ff9d7ff28377">applyFourierFilter</a> (...)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a filter (defined in the frequency domain) to an image.  <a href="#gad51931cfe91ece316e28ff9d7ff28377"></a><br/></td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;... &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__FourierTransform.html#ga615ea159a1ac4328600ee44cbaa9a343">applyFourierFilterFamily</a> (...)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply an array of filters (defined in the frequency domain) to an image.  <a href="#ga615ea159a1ac4328600ee44cbaa9a343"></a><br/></td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;class T , int N&gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">TinyVector&lt; T, N &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__FourierTransform.html#gafbea828444f49163293b1d81fcd05da8">fftwCorrespondingShapeR2C</a> (TinyVector&lt; T, N &gt; shape)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Find frequency domain shape for a R2C Fourier transform.  <a href="#gafbea828444f49163293b1d81fcd05da8"></a><br/></td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;... &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__FourierTransform.html#gadd9dce5cef45cda228466002d00a0666">fourierTransform</a> (...)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute forward and inverse Fourier transforms.  <a href="#gadd9dce5cef45cda228466002d00a0666"></a><br/></td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;... &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__FourierTransform.html#ga478712099cf479694c81ccc5918aca73">fourierTransformInverse</a> (...)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute inverse Fourier transforms.  <a href="#ga478712099cf479694c81ccc5918aca73"></a><br/></td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;... &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__FourierTransform.html#ga99f1f190a25ea2dbdc78c4e18c25699d">fourierTransformReal</a> (...)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Real Fourier transforms for even and odd boundary conditions (aka. cosine and sine transforms).  <a href="#ga99f1f190a25ea2dbdc78c4e18c25699d"></a><br/></td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;... &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__FourierTransform.html#gaecb29642aab8a911b4f53e289d31e5e5">moveDCToCenter</a> (...)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Rearrange the quadrants of a Fourier image so that the origin is in the image center.  <a href="#gaecb29642aab8a911b4f53e289d31e5e5"></a><br/></td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;... &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__FourierTransform.html#gaee27c376079af99e8e2148e7d23ffbbb">moveDCToUpperLeft</a> (...)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Rearrange the quadrants of a Fourier image so that the origin is in the image's upper left.  <a href="#gaee27c376079af99e8e2148e7d23ffbbb"></a><br/></td></tr>
</table>
<hr/><a name="_details" id="details"></a><h2 class="details_section">Detailed Description</h2>
<p>VIGRA provides a powerful C++ API for the popular <a href="http://www.fftw.org/">FFTW library</a> for fast Fourier transforms. There are two versions of the API: an older one based on image iterators (and therefore restricted to 2D) and a new one based on <a class="el" href="classvigra_1_1MultiArrayView.html">MultiArrayView</a> that works for arbitrary dimensions. In addition, the functions <a class="el" href="group__MultiArrayConvolutionFilters.html#gaaf819a613a16ee9807d69ecb2d91b2ae">convolveFFT()</a> and <a class="el" href="group__FourierTransform.html#gad51931cfe91ece316e28ff9d7ff28377">applyFourierFilter()</a> provide an easy-to-use interface for FFT-based convolution, a major application of Fourier transforms. </p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="gaecb29642aab8a911b4f53e289d31e5e5"></a><!-- doxytag: member="vigra::moveDCToCenter" ref="gaecb29642aab8a911b4f53e289d31e5e5" args="(...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__FourierTransform.html#gaecb29642aab8a911b4f53e289d31e5e5">vigra::moveDCToCenter</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rearrange the quadrants of a Fourier image so that the origin is in the image center. </p>
<p>FFTW produces fourier images where the DC component (origin of fourier space) is located in the upper left corner of the image. The quadrants are placed like this (using a 4x4 image for example):</p>
<div class="fragment"><pre class="fragment">            DC 4 3 3
             4 4 3 3
             1 1 2 2
             1 1 2 2
</pre></div><p>After applying the function, the quadrants are at their usual places:</p>
<div class="fragment"><pre class="fragment">            2 2  1 1
            2 2  1 1
            3 3 DC 4
            3 3  4 4
</pre></div><p>This transformation can be reversed by <a class="el" href="group__FourierTransform.html#gaee27c376079af99e8e2148e7d23ffbbb">moveDCToUpperLeft()</a>. Note that the 2D versions of this transformation must not be executed in place - input and output images must be different. In contrast, the nD version (with <a class="el" href="classvigra_1_1MultiArrayView.html" title="Base class for, and view to, vigra::MultiArray.">MultiArrayView</a> argument) always works in-place.</p>
<p><b> Declarations:</b></p>
<p>use <a class="el" href="classvigra_1_1MultiArrayView.html" title="Base class for, and view to, vigra::MultiArray.">MultiArrayView</a> (this works in-place, with arbitrary dimension N): </p>
<div class="fragment"><pre class="fragment">    <span class="keyword">namespace </span>vigra {
        <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> N, <span class="keyword">class</span> T, <span class="keyword">class</span> Str<span class="keywordtype">id</span>e&gt;
        <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gaecb29642aab8a911b4f53e289d31e5e5" title="Rearrange the quadrants of a Fourier image so that the origin is in the image center.">moveDCToCenter</a>(MultiArrayView&lt;N, T, Stride&gt; a);
    }
</pre></div><p>pass iterators explicitly (2D only, not in-place): </p>
<div class="fragment"><pre class="fragment">    <span class="keyword">namespace </span>vigra {
        <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcImageIterator, <span class="keyword">class </span>SrcAccessor,
                  <span class="keyword">class </span>DestImageIterator, <span class="keyword">class </span>DestAccessor&gt;
        <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gaecb29642aab8a911b4f53e289d31e5e5" title="Rearrange the quadrants of a Fourier image so that the origin is in the image center.">moveDCToCenter</a>(SrcImageIterator src_upperleft,
                               SrcImageIterator src_lowerright, SrcAccessor sa,
                               DestImageIterator dest_upperleft, DestAccessor da);
    }
</pre></div><p>use argument objects in conjunction with <a class="el" href="ArgumentObjectFactories.html">Argument Object Factories</a> (2D only, not in-place): </p>
<div class="fragment"><pre class="fragment">    <span class="keyword">namespace </span>vigra {
        <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcImageIterator, <span class="keyword">class </span>SrcAccessor,
                  <span class="keyword">class </span>DestImageIterator, <span class="keyword">class </span>DestAccessor&gt;
        <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gaecb29642aab8a911b4f53e289d31e5e5" title="Rearrange the quadrants of a Fourier image so that the origin is in the image center.">moveDCToCenter</a>(
            triple&lt;SrcImageIterator, SrcImageIterator, SrcAccessor&gt; src,
            pair&lt;DestImageIterator, DestAccessor&gt; dest);
    }
</pre></div><p><b> Usage:</b></p>
<p><b>#include</b> &lt;<a class="el" href="fftw3_8hxx_source.html">vigra/fftw3.hxx</a>&gt; (for 2D variants) <br/>
 <b>#include</b> &lt;<a class="el" href="multi__fft_8hxx_source.html">vigra/multi_fft.hxx</a>&gt; (for nD variants) <br/>
 Namespace: vigra</p>
<div class="fragment"><pre class="fragment">    <a class="code" href="classvigra_1_1BasicImage.html" title="Fundamental class template for images.">vigra::FFTWComplexImage</a> spatial(width,height), fourier(width,height);
    ... <span class="comment">// fill image with data</span>

    <span class="comment">// create a plan with estimated performance optimization</span>
    fftw_plan forwardPlan = fftw_plan_dft_2d(height, width,
                                (fftw_complex *)spatial.begin(), (fftw_complex *)fourier.begin(),
                                FFTW_FORWARD, FFTW_ESTIMATE );
    <span class="comment">// calculate FFT</span>
    fftw_execute(forwardPlan);

    <a class="code" href="classvigra_1_1BasicImage.html" title="Fundamental class template for images.">vigra::FFTWComplexImage</a> rearrangedFourier(width, height);
    <a class="code" href="group__FourierTransform.html#gaecb29642aab8a911b4f53e289d31e5e5" title="Rearrange the quadrants of a Fourier image so that the origin is in the image center.">moveDCToCenter</a>(srcImageRange(fourier), destImage(rearrangedFourier));

    <span class="comment">// delete the plan</span>
    fftw_destroy_plan(forwardPlan);
</pre></div> 
</div>
</div>
<a class="anchor" id="gaee27c376079af99e8e2148e7d23ffbbb"></a><!-- doxytag: member="vigra::moveDCToUpperLeft" ref="gaee27c376079af99e8e2148e7d23ffbbb" args="(...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__FourierTransform.html#gaee27c376079af99e8e2148e7d23ffbbb">vigra::moveDCToUpperLeft</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rearrange the quadrants of a Fourier image so that the origin is in the image's upper left. </p>
<p>This function is the inversion of <a class="el" href="group__FourierTransform.html#gaecb29642aab8a911b4f53e289d31e5e5">moveDCToCenter()</a>. See there for a detailed description and usage examples.</p>
<p><b> Declarations:</b></p>
<p>use <a class="el" href="classvigra_1_1MultiArrayView.html" title="Base class for, and view to, vigra::MultiArray.">MultiArrayView</a> (this works in-place, with arbitrary dimension N): </p>
<div class="fragment"><pre class="fragment">    <span class="keyword">namespace </span>vigra {
        <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> N, <span class="keyword">class</span> T, <span class="keyword">class</span> Str<span class="keywordtype">id</span>e&gt;
        <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gaee27c376079af99e8e2148e7d23ffbbb" title="Rearrange the quadrants of a Fourier image so that the origin is in the image&#39;s upper left...">moveDCToUpperLeft</a>(MultiArrayView&lt;N, T, Stride&gt; a);
    }
</pre></div><p>pass iterators explicitly (2D only, not in-place): </p>
<div class="fragment"><pre class="fragment">        <span class="keyword">namespace </span>vigra {
            <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcImageIterator, <span class="keyword">class </span>SrcAccessor,
                      <span class="keyword">class </span>DestImageIterator, <span class="keyword">class </span>DestAccessor&gt;
            <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gaee27c376079af99e8e2148e7d23ffbbb" title="Rearrange the quadrants of a Fourier image so that the origin is in the image&#39;s upper left...">moveDCToUpperLeft</a>(SrcImageIterator src_upperleft,
                                   SrcImageIterator src_lowerright, SrcAccessor sa,
                                   DestImageIterator dest_upperleft, DestAccessor da);
        }
</pre></div><p>use argument objects in conjunction with <a class="el" href="ArgumentObjectFactories.html">Argument Object Factories</a> (2D only, not in-place): </p>
<div class="fragment"><pre class="fragment">        <span class="keyword">namespace </span>vigra {
            <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcImageIterator, <span class="keyword">class </span>SrcAccessor,
                      <span class="keyword">class </span>DestImageIterator, <span class="keyword">class </span>DestAccessor&gt;
            <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gaee27c376079af99e8e2148e7d23ffbbb" title="Rearrange the quadrants of a Fourier image so that the origin is in the image&#39;s upper left...">moveDCToUpperLeft</a>(
                triple&lt;SrcImageIterator, SrcImageIterator, SrcAccessor&gt; src,
                pair&lt;DestImageIterator, DestAccessor&gt; dest);
        }
</pre></div> 
</div>
</div>
<a class="anchor" id="gadd9dce5cef45cda228466002d00a0666"></a><!-- doxytag: member="vigra::fourierTransform" ref="gadd9dce5cef45cda228466002d00a0666" args="(...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__FourierTransform.html#gadd9dce5cef45cda228466002d00a0666">vigra::fourierTransform</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Compute forward and inverse Fourier transforms. </p>
<p>The array referring to the spatial domain (i.e. the input in a forward transform, and the output in an inverse transform) may be scalar or complex. The array representing the frequency domain (i.e. output for forward transform, input for inverse transform) must always be complex.</p>
<p>The new implementations (those using <a class="el" href="classvigra_1_1MultiArrayView.html" title="Base class for, and view to, vigra::MultiArray.">MultiArrayView</a> arguments) perform a normalized transform, whereas the old ones (using 2D iterators or argument objects) perform an un-normalized transform (i.e. the result of the inverse transform is scaled by the number of pixels).</p>
<p>In general, input and output arrays must have the same shape, with the exception of the special <a href="http://www.fftw.org/doc/Multi_002dDimensional-DFTs-of-Real-Data.html">R2C and C2R modes</a> defined by FFTW.</p>
<p>The R2C transform reduces the redundancy in the Fourier representation of a real-valued signal: Since the Fourier representation of a real signal is symmetric, about half of the Fourier coefficients can simply be dropped. By convention, this reduction is applied to the first (innermost) dimension, such that <code>fourier.shape(0) == spatial.shape(0)/2 + 1</code> holds. The correct frequency domain shape can be conveniently computed by means of the function <a class="el" href="group__FourierTransform.html#gafbea828444f49163293b1d81fcd05da8">fftwCorrespondingShapeR2C()</a>.</p>
<p>Note that your program must always link against <code>libfftw3</code>. If you want to compute Fourier transforms for <code>float</code> or <code>long double</code> arrays, you must <em>additionally</em> link against <code>libfftw3f</code> and <code>libfftw3l</code> respectively. (Old-style functions only support <code>double</code>).</p>
<p>The Fourier transform functions internally create <a href="http://www.fftw.org/doc/Using-Plans.html">FFTW plans</a> which control the algorithm details. The plans are creates with the flag <code>FFTW_ESTIMATE</code>, i.e. optimal settings are guessed or read from saved "wisdom" files. If you need more control over planning, you can use the class <a class="el" href="classvigra_1_1FFTWPlan.html">FFTWPlan</a>.</p>
<p><b> Declarations:</b></p>
<p>use complex-valued <a class="el" href="classvigra_1_1MultiArrayView.html" title="Base class for, and view to, vigra::MultiArray.">MultiArrayView</a> arguments (this works for arbitrary dimension N): </p>
<div class="fragment"><pre class="fragment">    <span class="keyword">namespace </span>vigra {
        <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> N, <span class="keyword">class</span> Real, <span class="keyword">class</span> C1, <span class="keyword">class</span> C2&gt;
        <span class="keywordtype">void</span> 
        <a class="code" href="group__FourierTransform.html#gadd9dce5cef45cda228466002d00a0666" title="Compute forward and inverse Fourier transforms.">fourierTransform</a>(MultiArrayView&lt;N, FFTWComplex&lt;Real&gt;, C1&gt; in, 
                         MultiArrayView&lt;N, FFTWComplex&lt;Real&gt;, C2&gt; out);

        <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> N, <span class="keyword">class</span> Real, <span class="keyword">class</span> C1, <span class="keyword">class</span> C2&gt;
        <span class="keywordtype">void</span> 
        <a class="code" href="group__FourierTransform.html#ga478712099cf479694c81ccc5918aca73" title="Compute inverse Fourier transforms.">fourierTransformInverse</a>(MultiArrayView&lt;N, FFTWComplex&lt;Real&gt;, C1&gt; in, 
                                MultiArrayView&lt;N, FFTWComplex&lt;Real&gt;, C2&gt; out);
    }
</pre></div><p>use real-valued <a class="el" href="classvigra_1_1MultiArrayView.html" title="Base class for, and view to, vigra::MultiArray.">MultiArrayView</a> in the spatial domain, complex-valued <a class="el" href="classvigra_1_1MultiArrayView.html" title="Base class for, and view to, vigra::MultiArray.">MultiArrayView</a> in the frequency domain (this works for arbitrary dimension N, and also supports the R2C and C2R transform, depending on the array shape in the frequency domain): </p>
<div class="fragment"><pre class="fragment">    <span class="keyword">namespace </span>vigra {
        <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> N, <span class="keyword">class</span> Real, <span class="keyword">class</span> C1, <span class="keyword">class</span> C2&gt;
        <span class="keywordtype">void</span> 
        <a class="code" href="group__FourierTransform.html#gadd9dce5cef45cda228466002d00a0666" title="Compute forward and inverse Fourier transforms.">fourierTransform</a>(MultiArrayView&lt;N, Real, C1&gt; in, 
                         MultiArrayView&lt;N, FFTWComplex&lt;Real&gt;, C2&gt; out);

        <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> N, <span class="keyword">class</span> Real, <span class="keyword">class</span> C1, <span class="keyword">class</span> C2&gt;
        <span class="keywordtype">void</span> 
        <a class="code" href="group__FourierTransform.html#ga478712099cf479694c81ccc5918aca73" title="Compute inverse Fourier transforms.">fourierTransformInverse</a>(MultiArrayView&lt;N, FFTWComplex&lt;Real&gt;, C1&gt; in, 
                                MultiArrayView&lt;N, Real, C2&gt; out);
    }
</pre></div><p>pass iterators explicitly (2D only, double only): </p>
<div class="fragment"><pre class="fragment">    <span class="keyword">namespace </span>vigra {
        <span class="keyword">template</span> &lt;<span class="keyword">class</span> SrcImageIterator, <span class="keyword">class</span> SrcAccessor&gt;
        <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gadd9dce5cef45cda228466002d00a0666" title="Compute forward and inverse Fourier transforms.">fourierTransform</a>(SrcImageIterator srcUpperLeft,
                              SrcImageIterator srcLowerRight, SrcAccessor src,
                              <a class="code" href="classvigra_1_1BasicImage.html#a94032047b4445f0822d7508a3ffff034">FFTWComplexImage::traverser</a> destUpperLeft, <a class="code" href="classvigra_1_1BasicImage.html#a28a41780fa37a19501034e86747e45b7">FFTWComplexImage::Accessor</a> dest);

        <span class="keywordtype">void</span>
        <a class="code" href="group__FourierTransform.html#ga478712099cf479694c81ccc5918aca73" title="Compute inverse Fourier transforms.">fourierTransformInverse</a>(<a class="code" href="classvigra_1_1BasicImage.html#a0e56cb0f6842d3f9f30361ca669a3b15">FFTWComplexImage::const_traverser</a> sul,
                                <a class="code" href="classvigra_1_1BasicImage.html#a0e56cb0f6842d3f9f30361ca669a3b15">FFTWComplexImage::const_traverser</a> slr, <a class="code" href="classvigra_1_1BasicImage.html#a65676f5294c2039d907f09346c4c2b4c">FFTWComplexImage::ConstAccessor</a> src,
                                <a class="code" href="classvigra_1_1BasicImage.html#a94032047b4445f0822d7508a3ffff034">FFTWComplexImage::traverser</a> dul, <a class="code" href="classvigra_1_1BasicImage.html#a28a41780fa37a19501034e86747e45b7">FFTWComplexImage::Accessor</a> dest)
    }
</pre></div><p>use argument objects in conjunction with <a class="el" href="ArgumentObjectFactories.html">Argument Object Factories</a> (2D only, double only): </p>
<div class="fragment"><pre class="fragment">    <span class="keyword">namespace </span>vigra {
        <span class="keyword">template</span> &lt;<span class="keyword">class</span> SrcImageIterator, <span class="keyword">class</span> SrcAccessor&gt;
        <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gadd9dce5cef45cda228466002d00a0666" title="Compute forward and inverse Fourier transforms.">fourierTransform</a>(triple&lt;SrcImageIterator, SrcImageIterator, SrcAccessor&gt; src,
                              pair&lt;FFTWComplexImage::traverser, FFTWComplexImage::Accessor&gt; dest);

        <span class="keywordtype">void</span>
        <a class="code" href="group__FourierTransform.html#ga478712099cf479694c81ccc5918aca73" title="Compute inverse Fourier transforms.">fourierTransformInverse</a>(triple&lt;<a class="code" href="classvigra_1_1BasicImage.html#a0e56cb0f6842d3f9f30361ca669a3b15">FFTWComplexImage::const_traverser</a>,
                                       <a class="code" href="classvigra_1_1BasicImage.html#a0e56cb0f6842d3f9f30361ca669a3b15">FFTWComplexImage::const_traverser</a>, <a class="code" href="classvigra_1_1BasicImage.html#a65676f5294c2039d907f09346c4c2b4c">FFTWComplexImage::ConstAccessor</a>&gt; src,
                                pair&lt;FFTWComplexImage::traverser, FFTWComplexImage::Accessor&gt; dest);
    }
</pre></div><p><b> Usage:</b></p>
<p><b>#include</b> &lt;<a class="el" href="fftw3_8hxx_source.html">vigra/fftw3.hxx</a>&gt; (old-style 2D variants)<br/>
 <b>#include</b> &lt;<a class="el" href="multi__fft_8hxx_source.html">vigra/multi_fft.hxx</a>&gt; (new-style nD variants)<br/>
 Namespace: vigra</p>
<p>old-style example (using FFTWComplexImage): </p>
<div class="fragment"><pre class="fragment">    <span class="comment">// compute complex Fourier transform of a real image, old-style implementation</span>
    <a class="code" href="classvigra_1_1BasicImage.html">vigra::DImage</a> src(w, h);
    <a class="code" href="classvigra_1_1BasicImage.html" title="Fundamental class template for images.">vigra::FFTWComplexImage</a> fourier(w, h);

    <a class="code" href="group__FourierTransform.html#gadd9dce5cef45cda228466002d00a0666" title="Compute forward and inverse Fourier transforms.">fourierTransform</a>(srcImageRange(src), destImage(fourier));

    <span class="comment">// compute inverse Fourier transform</span>
    <span class="comment">// note that both source and destination image must be of type vigra::FFTWComplexImage</span>
    <a class="code" href="classvigra_1_1BasicImage.html" title="Fundamental class template for images.">vigra::FFTWComplexImage</a> inverseFourier(w, h);

    <a class="code" href="group__FourierTransform.html#ga478712099cf479694c81ccc5918aca73" title="Compute inverse Fourier transforms.">fourierTransformInverse</a>(srcImageRange(fourier), destImage(inverseFourier));
</pre></div><p>new-style examples (using <a class="el" href="classvigra_1_1MultiArray.html" title="Main MultiArray class containing the memory management.">MultiArray</a>): </p>
<div class="fragment"><pre class="fragment">    <span class="comment">// compute Fourier transform of a real array, using the R2C algorithm</span>
    MultiArray&lt;2, double&gt; src(<a class="code" href="group__MultiIteratorGroup.html#ga2e2ffc107bb0e38f9b1288b647c8ec5b" title="shape type for MultiArray&lt;2, T&gt;">Shape2</a>(w, h));
    MultiArray&lt;2, FFTWComplex&lt;double&gt; &gt; fourier(<a class="code" href="group__FourierTransform.html#gafbea828444f49163293b1d81fcd05da8" title="Find frequency domain shape for a R2C Fourier transform.">fftwCorrespondingShapeR2C</a>(src.shape()));

    <a class="code" href="group__FourierTransform.html#gadd9dce5cef45cda228466002d00a0666" title="Compute forward and inverse Fourier transforms.">fourierTransform</a>(src, fourier);

    <span class="comment">// compute inverse Fourier transform, using the C2R algorithm</span>
    MultiArray&lt;2, double&gt; dest(src.shape());
    <a class="code" href="group__FourierTransform.html#ga478712099cf479694c81ccc5918aca73" title="Compute inverse Fourier transforms.">fourierTransformInverse</a>(fourier, dest);
</pre></div><div class="fragment"><pre class="fragment">    <span class="comment">// compute Fourier transform of a real array with standard algorithm</span>
    MultiArray&lt;2, double&gt; src(<a class="code" href="group__MultiIteratorGroup.html#ga2e2ffc107bb0e38f9b1288b647c8ec5b" title="shape type for MultiArray&lt;2, T&gt;">Shape2</a>(w, h));
    MultiArray&lt;2, FFTWComplex&lt;double&gt; &gt; fourier(src.shape());

    <a class="code" href="group__FourierTransform.html#gadd9dce5cef45cda228466002d00a0666" title="Compute forward and inverse Fourier transforms.">fourierTransform</a>(src, fourier);

    <span class="comment">// compute inverse Fourier transform, using the C2R algorithm</span>
    MultiArray&lt;2, double&gt; dest(src.shape());
    <a class="code" href="group__FourierTransform.html#ga478712099cf479694c81ccc5918aca73" title="Compute inverse Fourier transforms.">fourierTransformInverse</a>(fourier, dest);
</pre></div><p> Complex input arrays are handled in the same way. </p>

</div>
</div>
<a class="anchor" id="ga478712099cf479694c81ccc5918aca73"></a><!-- doxytag: member="vigra::fourierTransformInverse" ref="ga478712099cf479694c81ccc5918aca73" args="(...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__FourierTransform.html#ga478712099cf479694c81ccc5918aca73">vigra::fourierTransformInverse</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Compute inverse Fourier transforms. </p>
<p>See <a class="el" href="group__FourierTransform.html#gadd9dce5cef45cda228466002d00a0666">fourierTransform()</a> for details. </p>

</div>
</div>
<a class="anchor" id="gad51931cfe91ece316e28ff9d7ff28377"></a><!-- doxytag: member="vigra::applyFourierFilter" ref="gad51931cfe91ece316e28ff9d7ff28377" args="(...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__FourierTransform.html#gad51931cfe91ece316e28ff9d7ff28377">vigra::applyFourierFilter</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a filter (defined in the frequency domain) to an image. </p>
<p>After transferring the image into the frequency domain, it is multiplied pixel-wise with the filter and transformed back. The result is put into the given destination image which must have the right size. The result will be normalized to compensate for the two FFTs.</p>
<p>If the destination image is scalar, only the real part of the result image is retained. In this case, you are responsible for choosing a filter image which ensures a zero imaginary part of the result (e.g. use a real, even symmetric filter image, or a purely imaginary, odd symmetric one).</p>
<p>The DC entry of the filter must be in the upper left, which is the position where FFTW expects it (see <a class="el" href="group__FourierTransform.html#gaee27c376079af99e8e2148e7d23ffbbb">moveDCToUpperLeft()</a>).</p>
<p>See also <a class="el" href="group__MultiArrayConvolutionFilters.html#gaaf819a613a16ee9807d69ecb2d91b2ae">convolveFFT()</a> for corresponding functionality on the basis of the <a class="el" href="classvigra_1_1MultiArrayView.html">MultiArrayView</a> interface.</p>
<p><b> Declarations:</b></p>
<p>pass 2D array views: </p>
<div class="fragment"><pre class="fragment">    <span class="keyword">namespace </span>vigra {
        <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcImageIterator, <span class="keyword">class </span>SrcAccessor,
                  <span class="keyword">class </span>FilterImageIterator, <span class="keyword">class </span>FilterAccessor,
                  <span class="keyword">class </span>DestImageIterator, <span class="keyword">class </span>DestAccessor&gt;
        <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gad51931cfe91ece316e28ff9d7ff28377" title="Apply a filter (defined in the frequency domain) to an image.">applyFourierFilter</a>(SrcImageIterator srcUpperLeft,
                                SrcImageIterator srcLowerRight, SrcAccessor sa,
                                FilterImageIterator filterUpperLeft, FilterAccessor fa,
                                DestImageIterator destUpperLeft, DestAccessor da);
    }
</pre></div><p>pass <a class="el" href="group__ImageIterators.html">Image Iterators</a> and <a class="el" href="group__DataAccessors.html">Data Accessors</a> : </p>
<div class="fragment"><pre class="fragment">    <span class="keyword">namespace </span>vigra {
        <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcImageIterator, <span class="keyword">class </span>SrcAccessor,
                  <span class="keyword">class </span>FilterImageIterator, <span class="keyword">class </span>FilterAccessor,
                  <span class="keyword">class </span>DestImageIterator, <span class="keyword">class </span>DestAccessor&gt;
        <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gad51931cfe91ece316e28ff9d7ff28377" title="Apply a filter (defined in the frequency domain) to an image.">applyFourierFilter</a>(SrcImageIterator srcUpperLeft,
                                SrcImageIterator srcLowerRight, SrcAccessor sa,
                                FilterImageIterator filterUpperLeft, FilterAccessor fa,
                                DestImageIterator destUpperLeft, DestAccessor da);
    }
</pre></div><p>use argument objects in conjunction with <a class="el" href="ArgumentObjectFactories.html">Argument Object Factories</a> : </p>
<div class="fragment"><pre class="fragment">    <span class="keyword">namespace </span>vigra {
        <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcImageIterator, <span class="keyword">class </span>SrcAccessor,
                  <span class="keyword">class </span>FilterImageIterator, <span class="keyword">class </span>FilterAccessor,
                  <span class="keyword">class </span>DestImageIterator, <span class="keyword">class </span>DestAccessor&gt;
        <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gad51931cfe91ece316e28ff9d7ff28377" title="Apply a filter (defined in the frequency domain) to an image.">applyFourierFilter</a>(triple&lt;SrcImageIterator, SrcImageIterator, SrcAccessor&gt; src,
                                pair&lt;FilterImageIterator, FilterAccessor&gt; filter,
                                pair&lt;DestImageIterator, DestAccessor&gt; dest);
    }
</pre></div><p><b> Usage:</b></p>
<p><b>#include</b> &lt;<a class="el" href="fftw3_8hxx_source.html">vigra/fftw3.hxx</a>&gt;<br/>
 Namespace: vigra</p>
<div class="fragment"><pre class="fragment">    <span class="comment">// create a Gaussian filter in Fourier space</span>
    <a class="code" href="classvigra_1_1BasicImage.html" title="Fundamental class template for images.">vigra::FImage</a> gaussFilter(w, h), filter(w, h);
    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> y=0; y&lt;h; ++y)
        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> x=0; x&lt;w; ++x)
        {
            xx = float(x - w / 2) / w;
            yy = float(y - h / 2) / h;

            gaussFilter(x,y) = <a class="code" href="group__LinearAlgebraFunctions.html#ga2a9e01ae7ae7b39a618e9f4a6afaee5b">std::exp</a>(-(xx*xx + yy*yy) / 2.0 * scale);
        }

    <span class="comment">// applyFourierFilter() expects the filter&#39;s DC in the upper left</span>
    <a class="code" href="group__FourierTransform.html#gaee27c376079af99e8e2148e7d23ffbbb" title="Rearrange the quadrants of a Fourier image so that the origin is in the image&#39;s upper left...">moveDCToUpperLeft</a>(srcImageRange(gaussFilter), destImage(filter));

    <a class="code" href="classvigra_1_1BasicImage.html" title="Fundamental class template for images.">vigra::FFTWComplexImage</a> result(w, h);

    <a class="code" href="group__FourierTransform.html#gad51931cfe91ece316e28ff9d7ff28377" title="Apply a filter (defined in the frequency domain) to an image.">vigra::applyFourierFilter</a>(srcImageRange(image), srcImage(filter), result);
</pre></div><p>For inspection of the result, <a class="el" href="classvigra_1_1FFTWMagnitudeAccessor.html">FFTWMagnitudeAccessor</a> might be useful. If you want to apply the same filter repeatedly, it may be more efficient to use the FFTW functions directly with FFTW plans optimized for good performance. </p>

</div>
</div>
<a class="anchor" id="ga615ea159a1ac4328600ee44cbaa9a343"></a><!-- doxytag: member="vigra::applyFourierFilterFamily" ref="ga615ea159a1ac4328600ee44cbaa9a343" args="(...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__FourierTransform.html#ga615ea159a1ac4328600ee44cbaa9a343">vigra::applyFourierFilterFamily</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply an array of filters (defined in the frequency domain) to an image. </p>
<p>This provides the same functionality as <a class="el" href="group__FourierTransform.html#gad51931cfe91ece316e28ff9d7ff28377">applyFourierFilter()</a>, but applying several filters at once allows to avoid repeated Fourier transforms of the source image.</p>
<p>Filters and result images must be stored in <a class="el" href="classvigra_1_1ImageArray.html">vigra::ImageArray</a> data structures. In contrast to <a class="el" href="group__FourierTransform.html#gad51931cfe91ece316e28ff9d7ff28377">applyFourierFilter()</a>, this function adjusts the size of the result images and the the length of the array.</p>
<p><b> Declarations:</b></p>
<p>pass 2D array views: </p>
<div class="fragment"><pre class="fragment">    <span class="keyword">namespace </span>vigra {
        <span class="keyword">template</span> &lt;<span class="keyword">class</span> SrcImageIterator, <span class="keyword">class</span> SrcAccessor, <span class="keyword">class</span> FilterType&gt;
        <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#ga615ea159a1ac4328600ee44cbaa9a343" title="Apply an array of filters (defined in the frequency domain) to an image.">applyFourierFilterFamily</a>(SrcImageIterator srcUpperLeft,
                                      SrcImageIterator srcLowerRight, SrcAccessor sa,
                                      <span class="keyword">const</span> ImageArray&lt;FilterType&gt; &amp;filters,
                                      ImageArray&lt;FFTWComplexImage&gt; &amp;results)
    }
</pre></div><p>pass <a class="el" href="group__ImageIterators.html">Image Iterators</a> and <a class="el" href="group__DataAccessors.html">Data Accessors</a> : </p>
<div class="fragment"><pre class="fragment">    <span class="keyword">namespace </span>vigra {
        <span class="keyword">template</span> &lt;<span class="keyword">class</span> SrcImageIterator, <span class="keyword">class</span> SrcAccessor, <span class="keyword">class</span> FilterType&gt;
        <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#ga615ea159a1ac4328600ee44cbaa9a343" title="Apply an array of filters (defined in the frequency domain) to an image.">applyFourierFilterFamily</a>(SrcImageIterator srcUpperLeft,
                                      SrcImageIterator srcLowerRight, SrcAccessor sa,
                                      <span class="keyword">const</span> ImageArray&lt;FilterType&gt; &amp;filters,
                                      ImageArray&lt;FFTWComplexImage&gt; &amp;results)
    }
</pre></div><p>use argument objects in conjunction with <a class="el" href="ArgumentObjectFactories.html">Argument Object Factories</a> : </p>
<div class="fragment"><pre class="fragment">    <span class="keyword">namespace </span>vigra {
        <span class="keyword">template</span> &lt;<span class="keyword">class</span> SrcImageIterator, <span class="keyword">class</span> SrcAccessor, <span class="keyword">class</span> FilterType&gt;
        <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#ga615ea159a1ac4328600ee44cbaa9a343" title="Apply an array of filters (defined in the frequency domain) to an image.">applyFourierFilterFamily</a>(triple&lt;SrcImageIterator, SrcImageIterator, SrcAccessor&gt; src,
                                      <span class="keyword">const</span> ImageArray&lt;FilterType&gt; &amp;filters,
                                      ImageArray&lt;FFTWComplexImage&gt; &amp;results)
    }
</pre></div><p><b> Usage:</b></p>
<p><b>#include</b> &lt;<a class="el" href="fftw3_8hxx_source.html">vigra/fftw3.hxx</a>&gt;<br/>
 Namespace: vigra</p>
<div class="fragment"><pre class="fragment">    <span class="comment">// assuming the presence of a real-valued image named &quot;image&quot; to</span>
    <span class="comment">// be filtered in this example</span>

    <a class="code" href="classvigra_1_1ImageArray.html" title="Fundamental class template for arrays of equal-sized images.">vigra::ImageArray&lt;vigra::FImage&gt;</a> filters(16, image.size());

    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;filters.size(); i++)
         <span class="comment">// create some meaningful filters here</span>
         createMyFilterOfScale(i, destImage(filters[i]));

    <a class="code" href="classvigra_1_1ImageArray.html" title="Fundamental class template for arrays of equal-sized images.">vigra::ImageArray&lt;vigra::FFTWComplexImage&gt;</a> results();

    <a class="code" href="group__FourierTransform.html#ga615ea159a1ac4328600ee44cbaa9a343" title="Apply an array of filters (defined in the frequency domain) to an image.">vigra::applyFourierFilterFamily</a>(srcImageRange(image), filters, results);
</pre></div> 
</div>
</div>
<a class="anchor" id="ga99f1f190a25ea2dbdc78c4e18c25699d"></a><!-- doxytag: member="vigra::fourierTransformReal" ref="ga99f1f190a25ea2dbdc78c4e18c25699d" args="(...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__FourierTransform.html#ga99f1f190a25ea2dbdc78c4e18c25699d">vigra::fourierTransformReal</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Real Fourier transforms for even and odd boundary conditions (aka. cosine and sine transforms). </p>
<p>If the image is real and has even symmetry, its Fourier transform is also real and has even symmetry. The Fourier transform of a real image with odd symmetry is imaginary and has odd symmetry. In either case, only about a quarter of the pixels need to be stored because the rest can be calculated from the symmetry properties. This is especially useful, if the original image is implicitly assumed to have reflective or anti-reflective boundary conditions. Then the "negative" pixel locations are defined as</p>
<div class="fragment"><pre class="fragment">    <a class="code" href="group__MathFunctions.html#ga3cf86b8d2300cd08b69024eb89f90115" title="Check if an integer is even.">even</a> (reflective boundary conditions):      f[-x] = f[x]     (x = 1,...,N-1)
    <a class="code" href="group__MathFunctions.html#ga48f661149941ebaa90ddd99ee5eee145" title="Check if an integer is odd.">odd</a> (anti-reflective boundary conditions):  f[-1] = 0
                                                f[-x] = -f[x-2]  (x = 2,...,N-1)
</pre></div><p>end similar at the other boundary (see the FFTW documentation for details). This has the advantage that more efficient Fourier transforms that use only real numbers can be implemented. These are also known as cosine and sine transforms respectively.</p>
<p>If you use the odd transform it is important to note that in the Fourier domain, the DC component is always zero and is therefore dropped from the data structure. This means that index 0 in an odd symmetric Fourier domain image refers to the <em>first</em> harmonic. This is especially important if an image is first cosine transformed (even symmetry), then in the Fourier domain multiplied with an odd symmetric filter (e.g. a first derivative) and finally transformed back to the spatial domain with a sine transform (odd symmetric). For this to work properly the image must be shifted left or up by one pixel (depending on whether the x- or y-axis is odd symmetric) before the inverse transform can be applied. (see example below).</p>
<p>The real Fourier transform functions are named <code>fourierTransformReal??</code> where the questions marks stand for either <code>E</code> or <code>O</code> indicating whether the x- and y-axis is to be transformed using even or odd symmetry. The same functions can be used for both the forward and inverse transforms, only the normalization changes. For signal processing, the following normalization factors are most appropriate:</p>
<div class="fragment"><pre class="fragment">                          forward             <a class="code" href="group__MatrixAlgebra.html#ga898e3fc2bdea632e7307604325b88016">inverse</a>
    ------------------------------------------------------------
    X <a class="code" href="group__MathFunctions.html#ga3cf86b8d2300cd08b69024eb89f90115" title="Check if an integer is even.">even</a>, Y even           1.0         4.0 * (w-1) * (h-1)
    X <a class="code" href="group__MathFunctions.html#ga3cf86b8d2300cd08b69024eb89f90115" title="Check if an integer is even.">even</a>, Y <a class="code" href="group__MathFunctions.html#ga48f661149941ebaa90ddd99ee5eee145" title="Check if an integer is odd.">odd</a>           -1.0        -4.0 * (w-1) * (h+1)
    X <a class="code" href="group__MathFunctions.html#ga48f661149941ebaa90ddd99ee5eee145" title="Check if an integer is odd.">odd</a>,  Y even          -1.0        -4.0 * (w+1) * (h-1)
    X <a class="code" href="group__MathFunctions.html#ga48f661149941ebaa90ddd99ee5eee145" title="Check if an integer is odd.">odd</a>,  Y odd            1.0         4.0 * (w+1) * (h+1)
</pre></div><p>where <code>w</code> and <code>h</code> denote the image width and height.</p>
<p><b> Declarations:</b></p>
<p>pass 2D array views: </p>
<div class="fragment"><pre class="fragment">    <span class="keyword">namespace </span>vigra {
        <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcTraverser, <span class="keyword">class </span>SrcAccessor,
                  <span class="keyword">class </span>DestTraverser, <span class="keyword">class </span>DestAccessor&gt;
        <span class="keywordtype">void</span>
        fourierTransformRealEE(SrcTraverser sul, SrcTraverser slr, SrcAccessor src,
                               DestTraverser dul, DestAccessor dest, fftw_real <a class="code" href="group__FFTWComplexOperators.html#ga396baa79e8bd78a178597d32d5152041" title="norm (= magnitude)">norm</a>);

        fourierTransformRealEO, fourierTransformRealOE, fourierTransformRealOO likewise
    }
</pre></div><p>pass <a class="el" href="group__ImageIterators.html">Image Iterators</a> and <a class="el" href="group__DataAccessors.html">Data Accessors</a> : </p>
<div class="fragment"><pre class="fragment">    <span class="keyword">namespace </span>vigra {
        <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcTraverser, <span class="keyword">class </span>SrcAccessor,
                  <span class="keyword">class </span>DestTraverser, <span class="keyword">class </span>DestAccessor&gt;
        <span class="keywordtype">void</span>
        fourierTransformRealEE(SrcTraverser sul, SrcTraverser slr, SrcAccessor src,
                               DestTraverser dul, DestAccessor dest, fftw_real <a class="code" href="group__FFTWComplexOperators.html#ga396baa79e8bd78a178597d32d5152041" title="norm (= magnitude)">norm</a>);

        fourierTransformRealEO, fourierTransformRealOE, fourierTransformRealOO likewise
    }
</pre></div><p>use argument objects in conjunction with <a class="el" href="ArgumentObjectFactories.html">Argument Object Factories</a> : </p>
<div class="fragment"><pre class="fragment">    <span class="keyword">namespace </span>vigra {
        <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcTraverser, <span class="keyword">class </span>SrcAccessor,
                  <span class="keyword">class </span>DestTraverser, <span class="keyword">class </span>DestAccessor&gt;
        <span class="keywordtype">void</span>
        fourierTransformRealEE(triple&lt;SrcTraverser, SrcTraverser, SrcAccessor&gt; src,
                               pair&lt;DestTraverser, DestAccessor&gt; dest, fftw_real <a class="code" href="group__FFTWComplexOperators.html#ga396baa79e8bd78a178597d32d5152041" title="norm (= magnitude)">norm</a>);

        fourierTransformRealEO, fourierTransformRealOE, fourierTransformRealOO likewise
    }
</pre></div><p><b> Usage:</b></p>
<p><b>#include</b> &lt;<a class="el" href="fftw3_8hxx_source.html">vigra/fftw3.hxx</a>&gt;<br/>
 Namespace: vigra</p>
<div class="fragment"><pre class="fragment">    <a class="code" href="classvigra_1_1BasicImage.html" title="Fundamental class template for images.">vigra::FImage</a> spatial(width,height), fourier(width,height);
    ... <span class="comment">// fill image with data</span>

    <span class="comment">// forward cosine transform == reflective boundary conditions</span>
    fourierTransformRealEE(srcImageRange(spatial), destImage(fourier), (fftw_real)1.0);

    <span class="comment">// multiply with a first derivative of Gaussian in x-direction</span>
    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> y = 0; y &lt; height; ++y)
    {
        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> x = 1; x &lt; width; ++x)
        {
            <span class="keywordtype">double</span> dx = x * M_PI / (width - 1);
            <span class="keywordtype">double</span> dy = y * M_PI / (height - 1);
            fourier(x-1, y) = fourier(x, y) * dx * <a class="code" href="group__LinearAlgebraFunctions.html#ga2a9e01ae7ae7b39a618e9f4a6afaee5b">std::exp</a>(-(dx*dx + dy*dy) * scale*scale / 2.0);
        }
        fourier(width-1, y) = 0.0;
    }

    <span class="comment">// inverse transform -- odd symmetry in x-direction, even in y,</span>
    <span class="comment">//                      due to symmetry of the filter</span>
    fourierTransformRealOE(srcImageRange(fourier), destImage(spatial),
                           (fftw_real)-4.0 * (width+1) * (height-1));
</pre></div> 
</div>
</div>
<a class="anchor" id="gafbea828444f49163293b1d81fcd05da8"></a><!-- doxytag: member="vigra::fftwCorrespondingShapeR2C" ref="gafbea828444f49163293b1d81fcd05da8" args="(TinyVector&lt; T, N &gt; shape)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TinyVector&lt;T, N&gt; <a class="el" href="group__FourierTransform.html#gafbea828444f49163293b1d81fcd05da8">vigra::fftwCorrespondingShapeR2C</a> </td>
          <td>(</td>
          <td class="paramtype">TinyVector&lt; T, N &gt;&#160;</td>
          <td class="paramname"><em>shape</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Find frequency domain shape for a R2C Fourier transform. </p>
<p>When a real valued array is transformed to the frequency domain, about half of the Fourier coefficients are redundant. The transform can be optimized as a <a href="http://www.fftw.org/doc/Multi_002dDimensional-DFTs-of-Real-Data.html">R2C transform</a> that doesn't compute and store the redundant coefficients. This function computes the appropriate frequency domain shape for a given shape in the spatial domain. It simply replaces <code>shape[0]</code> with <code>shape[0] / 2 + 1</code>.</p>
<p><b>#include</b> &lt;<a class="el" href="multi__fft_8hxx_source.html">vigra/multi_fft.hxx</a>&gt;<br/>
 Namespace: vigra </p>

</div>
</div>
</div><!-- contents -->
<!-- footer.html -->
<p>
<table border=0 cellspacing=0 width="100%"  bgcolor="#e0d0a0" cellpadding=5>
<tr>
<td>
<p>
<i>&copy; <A HREF="http://hci.iwr.uni-heidelberg.de/people/ukoethe/">Ullrich K&ouml;the</A>     (<A
HREF="mailto:ullrich.koethe@iwr.uni-heidelberg.de">ullrich.koethe@iwr.uni-heidelberg.de</A>)</i> <br>
<i><A HREF="http://hci.iwr.uni-heidelberg.de/">
Heidelberg Collaboratory for Image Processing</a>,
University of Heidelberg, Germany</i>
<td>
<p align=right>
<I>html generated using <A HREF="http://www.doxygen.org">doxygen</A> and <A HREF="http://www.python.org">Python</A></I>
<br>
<i>
vigra 1.9.1 (Thu Sep 5 2013)
</i>
</tr>
</table>


</BODY>
</HTML>
