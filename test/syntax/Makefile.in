curdir=.

test: test.o
	$(CXX) -o test test.o ||  { rm ./test$(EXEEXT).cxx ; exit 1; }
	./test || { rm ./test$(EXEEXT) ; exit 1; }

syntax.exe: test.d
	devenv "..\test.sln" /build Release /project syntax
	./syntax.exe || { rm ./syntax.exe ; exit 1; }

ifneq "$(MAKECMDGOALS)" "clean"
include test.d
endif

include ../Makefile.include

EXTRA_CLEAN_TARGET = test.cxx

CPPFLAGS := $(LIBCPPFLAGS) $(FFTW_INCLUDES)

HEADERS=$(shell ls $(vigra_srcdir)/include/vigra/*.hxx)

test.cxx: $(HEADERS)
	@echo creating test.cxx
	@\rm -f test.cxx && touch test.cxx
	@for i in $(HEADERS); do \
            j=`expr $$i : ".*/\(.*\)"` ; \
            if [ "$$j" != "fftw.hxx" -a "$$j" != "rfftw.hxx" ] ; then \
                echo "#include <vigra/$$j>" >> test.cxx; \
            fi; \
        done
	@echo "int main() {}" >> test.cxx

            
            
